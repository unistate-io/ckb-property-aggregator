{"version":3,"file":"helper.js","names":["_utils","require","_bytes","_base","_number","byteArrayOf","codec","byteLength","createFixedBytesCodec","pack","packable","unpack","buf","byteOf","byteVecOf","createBytesCodec","unpacked","payload","header","Uint32LE","concat","packed","assertMinBufferLength","slice","assertBufferLength"],"sources":["../../src/molecule/helper.ts"],"sourcesContent":["import { assertBufferLength, assertMinBufferLength } from \"../utils\";\nimport { concat } from \"../bytes\";\nimport {\n  BytesCodec,\n  createBytesCodec,\n  createFixedBytesCodec,\n  FixedBytesCodec,\n} from \"../base\";\nimport { Uint32LE } from \"../number\";\n\n/**\n * a helper function to create custom codec of `array SomeType [byte; n]`\n * @param codec\n */\nexport function byteArrayOf<Packed, Packable = Packed>(\n  codec: BytesCodec<Packed, Packable> & { byteLength: number }\n): FixedBytesCodec<Packed, Packable> {\n  const byteLength = codec.byteLength;\n  return createFixedBytesCodec({\n    byteLength,\n    pack: (packable) => codec.pack(packable),\n    unpack: (buf) => codec.unpack(buf),\n  });\n}\n\n/**\n * a helper function to create custom codec of `byte`\n * @param codec\n */\nexport function byteOf<Packed, Packable = Packed>(\n  codec: BytesCodec<Packed, Packable>\n): FixedBytesCodec<Packed, Packable> {\n  return byteArrayOf({ ...codec, byteLength: 1 });\n}\n\n/**\n * a helper function to create custom codec of `vector Bytes <byte>`\n * @param codec\n */\nexport function byteVecOf<Packed, Packable = Packed>(\n  codec: BytesCodec<Packed, Packable>\n): BytesCodec<Packed, Packable> {\n  return createBytesCodec({\n    pack(unpacked) {\n      const payload = codec.pack(unpacked);\n      const header = Uint32LE.pack(payload.byteLength);\n\n      return concat(header, payload);\n    },\n    unpack(packed) {\n      assertMinBufferLength(packed, 4);\n      const header = Uint32LE.unpack(packed.slice(0, 4));\n      assertBufferLength(packed.slice(4), header);\n      return codec.unpack(packed.slice(4));\n    },\n  });\n}\n"],"mappings":";;;;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,MAAA,GAAAD,OAAA;AACA,IAAAE,KAAA,GAAAF,OAAA;AAMA,IAAAG,OAAA,GAAAH,OAAA;AAEA;AACA;AACA;AACA;AACO,SAASI,WAAWA,CACzBC,KAA4D,EACzB;EACnC,MAAMC,UAAU,GAAGD,KAAK,CAACC,UAAU;EACnC,OAAO,IAAAC,2BAAqB,EAAC;IAC3BD,UAAU;IACVE,IAAI,EAAGC,QAAQ,IAAKJ,KAAK,CAACG,IAAI,CAACC,QAAQ,CAAC;IACxCC,MAAM,EAAGC,GAAG,IAAKN,KAAK,CAACK,MAAM,CAACC,GAAG;EACnC,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACO,SAASC,MAAMA,CACpBP,KAAmC,EACA;EACnC,OAAOD,WAAW,CAAC;IAAE,GAAGC,KAAK;IAAEC,UAAU,EAAE;EAAE,CAAC,CAAC;AACjD;;AAEA;AACA;AACA;AACA;AACO,SAASO,SAASA,CACvBR,KAAmC,EACL;EAC9B,OAAO,IAAAS,sBAAgB,EAAC;IACtBN,IAAIA,CAACO,QAAQ,EAAE;MACb,MAAMC,OAAO,GAAGX,KAAK,CAACG,IAAI,CAACO,QAAQ,CAAC;MACpC,MAAME,MAAM,GAAGC,gBAAQ,CAACV,IAAI,CAACQ,OAAO,CAACV,UAAU,CAAC;MAEhD,OAAO,IAAAa,aAAM,EAACF,MAAM,EAAED,OAAO,CAAC;IAChC,CAAC;IACDN,MAAMA,CAACU,MAAM,EAAE;MACb,IAAAC,4BAAqB,EAACD,MAAM,EAAE,CAAC,CAAC;MAChC,MAAMH,MAAM,GAAGC,gBAAQ,CAACR,MAAM,CAACU,MAAM,CAACE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;MAClD,IAAAC,yBAAkB,EAACH,MAAM,CAACE,KAAK,CAAC,CAAC,CAAC,EAAEL,MAAM,CAAC;MAC3C,OAAOZ,KAAK,CAACK,MAAM,CAACU,MAAM,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC;IACtC;EACF,CAAC,CAAC;AACJ"}